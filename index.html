<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>4-Week Payment Tracker</title>
<meta name="description" content="Dark theme payment tracker with weekly toggles and totals, saving to Firebase Firestore."/>
<style>
/* your same styles here... (unchanged for brevity) */
</style>
</head>
<body>
<div class="wrap">
<header>
<div>
<h1>4-Week Payment Tracker</h1>
<div class="sub">Dark theme ¬∑ Saves toggle state in Firebase Firestore</div>
</div>
<div class="sub">Total owed across all bills: <strong>$4,005</strong></div>
</header>

<section class="grid" id="weeks"></section>

<section class="card all" id="allBillsCard">
<h2>All Bills (within this 4-week window)</h2>
<div class="row head">
<div>Bill</div>
<div class="due">Due date</div>
<div class="amount">Amount</div>
<div>Status</div>
</div>
<div id="allBills"></div>
<div class="totals">
<div>Planned total: <span id="plannedTotal">$4,005</span></div>
<div>Marked paid: <span id="paidTotal" class="ok">$0</span></div>
<div>Remaining: <span id="remainingTotal" class="bad">$4,005</span></div>
</div>
<div class="progress"><i id="progressBar"></i></div>
<div class="foot">Click toggles to mark payments as paid ‚Äî changes are saved automatically to Firebase.</div>
</section>
</div>

<script type="module">
// DEBUG: tell us script is running
document.body.insertAdjacentHTML("afterbegin","<p style='color:lime;font-weight:bold'>‚úÖ Script running</p>");

// ====== Firebase imports ======
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-firestore.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.6.0/firebase-auth.js";

// DEBUG: error catcher ‚Äî show errors on page
window.addEventListener("error", e => {
  document.body.insertAdjacentHTML("beforeend", `<div style="color:red;font-weight:bold">üî• ${e.message}</div>`);
});
window.addEventListener("unhandledrejection", e => {
  document.body.insertAdjacentHTML("beforeend", `<div style="color:orange;font-weight:bold">‚ö†Ô∏è ${e.reason}</div>`);
});

// ====== Firebase config ======
const firebaseConfig = {
  apiKey: "AIzaSyC7ubmyUmeCAun50g-AUUOHiuwpGAys2HM",
  authDomain: "budget-tracker-1eea7.firebaseapp.com",
  projectId: "budget-tracker-1eea7",
  storageBucket: "budget-tracker-1eea7.appspot.com",
  messagingSenderId: "579597071031",
  appId: "1:579597071031:web:f30c2d42cc57268707d332"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const auth = getAuth(app);
const TOGGLE_DOC = doc(db, "toggles", "states");

// DEBUG
document.body.insertAdjacentHTML("beforeend","<div style='color:cyan'>üì° Firebase initialized</div>");

// ====== Your existing WEEKS + ALL_BILLS_ORDER arrays (unchanged) ======
const WEEKS = [
  { date: '08/22/2025', income: 2017, items: [
    { id: 'kicks', name: 'Kicks', amount: 472, due: '10/01/2025' },
    { id: 'progressive', name: 'Progressive', amount: 300, due: '09/15/2025' },
    { id: 'rogue', name: 'Rogue', amount: 700, due: '09/03/2025' },
    { id: 'fridge', name: 'Fridge', amount: 60, due: '09/01/2025' },
    { id: 'penasco', name: 'Pe√±asco', amount: 45, due: '09/01/2025' },
    { id: 'vegas', name: 'Vegas', amount: 51, due: '09/01/2025' },
    { id: 'amazon', name: 'Amazon Prime', amount: 50, due: '09/08/2025' }
  ]},
  { date: '08/29/2025', income: 650, items: [
    { id: 'hawaiian', name: 'Hawaiian Airlines', amount: 65, due: '09/15/2025' },
    { id: 'city', name: 'City of Phoenix', amount: 60, due: '09/04/2025' },
    { id: 'chase', name: 'Chase', amount: 125, due: '09/15/2025' },
    { id: 'frontier', name: 'Frontier', amount: 65, due: '09/15/2025' }
  ]},
  { date: '09/05/2025', income: 2017, items: [
    { id: 'house', name: 'House payment', amount: 950, due: '10/01/2025' },
    { id: 'qs3064', name: 'Quicksilver 3064', amount: 100, due: '09/11/2025' },
    { id: 'centurylink', name: 'Century Link', amount: 70, due: '09/13/2025' },
    { id: 'tmobile', name: 'T-Mobile', amount: 368, due: '09/15/2025' },
    { id: 'hoa', name: 'HOA', amount: 160, due: '09/01/2025' }
  ]},
  { date: '09/12/2025', income: 650, items: [
    { id: 'walmart', name: 'Walmart', amount: 75, due: '09/17/2025' },
    { id: 'qs5989', name: 'Quicksilver 5989', amount: 100, due: '09/15/2025' },
    { id: 'capitalone', name: 'Capital One', amount: 189, due: '09/10/2025' }
  ]}
];
const ALL_BILLS_ORDER = [
  'city','qs3064','progressive','centurylink','tmobile','house','rogue','hoa','kicks','amazon','walmart','qs5989','capitalone','frontier','chase','hawaiian','fridge','penasco','vegas'
];

// ====== Helper + main tracker logic (unchanged) ======
// (keep your initTracker, render, recalcTotals, etc. exactly as before)

// ====== Sign in & init ======
signInAnonymously(auth).catch(err => {
  document.body.insertAdjacentHTML("beforeend", `<div style="color:red">‚ùå Sign-in error: ${err.message}</div>`);
});
onAuthStateChanged(auth, user => {
  if(user) {
    document.body.insertAdjacentHTML("beforeend","<div style='color:lime'>üë§ Signed in anonymously</div>");
    initTracker();
  } else {
    document.body.insertAdjacentHTML("beforeend","<div style='color:red'>‚ö†Ô∏è User not signed in</div>");
  }
});
</script>
</body>
</html>